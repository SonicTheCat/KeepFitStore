@using KeepFitStore.Models.ViewModels.Orders

@model IEnumerable<AllOrdersViewModel>
@{
    ViewData["Title"] = "Administration - Orders";
}

<h1 class="mt-3">Orders</h1>
<button class="btn btn-link dropdown-toggle mt-1 mb-1 options-btn">Options</button>
<partial name="~/Areas/Administrator/Views/Partials/_AdminFilterOptionsForOrderPartial.cshtml" />
<partial name="~/Areas/Administrator/Views/Partials/_AdminListAllOrdersPartial.cshtml" />

@section Scripts {
    <script>
        $().ready(function () {
            $(".options-btn").click(function () {
                var optionsDiv = $("#filter-options");

                if (optionsDiv.hasClass("d-flex")) {
                    optionsDiv.removeClass("d-flex")
                } else {
                    optionsDiv.addClass("d-flex")
                }
                optionsDiv.toggle();
            });

            $(".filter-btn").click(function () {
                var boxes = $('input[type=checkbox]:checked');
                var urlQuery = "?";

                boxes.each(function (i, e) {
                    urlQuery = urlQuery + `filters=${$(e).val()}&`;
                });

                var radio = $('input[type=radio]:checked');
                if (radio[0] !== undefined) {
                     urlQuery = urlQuery + `sortBy=${radio.val()}`;
                }
               
                $(".content-orders")
                    .load(`/Administrator/Orders/Filter${urlQuery}`);
            })
        });
    </script>
}
